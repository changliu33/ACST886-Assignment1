---
title: "ACST886 Assignment1"
author: "Chang,Liu"
date: "20/08/2019"
output: word_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Question 1
Present value of expected cash flows
$L=\sum^{30}_{t= 1} instal\times ({\frac{1}{1+i}})^t $
```{r}
int<-.035
L<-600000
f<-function(instal){L-sum(instal*(1/(1+int))^(1:30))}
root<-uniroot(f,c(0,600000),tol = 0.001)
instal=root$root
instal
```

## Question 2
### part(a)
$Loanrepayment=L-Interestrepaid$
```{r}
int_repaid<-L*int
L_rep<-instal-int_repaid
L_rep
```

### part(b)

```{r}
Loan_offset<-100000
Loan_oust<-L
for (i in 1:30) {
  if(Loan_oust>instal){
    
    Interest_repaid<-(Loan_oust-Loan_offset)*int
    Loan_repaid<-instal-Interest_repaid
    Loan_oust<-Loan_oust-Loan_repaid
  }else{break("This is the last payment")}
  
}
cat("NO.of payment:",i)

cat("final smaller payment:",Loan_oust)

```

## Question 3

### Part a
Present Value:
$PV=\sum^{30}_{t= 1} Commision\times ({\frac{1}{1+i}})^t $
```{r}
Commision<-1000
int<-.035
PV<-sum(Commision*(1/(1+int))^(1:30))
PV
```
### Part b

The interest that the bank requires on its fund should be less than 3.5%, thus the aount paid by Bill actually includes the commission paid to Broker.

### Part c
The total amount paid by Bill
```{r}
Tol<-PV+L
Tol
```
The effective interest rate
$Tol=\sum^{30}_{t= 1} (Commision+Instalment)\times ({\frac{1}{1+i_e}})^t $
According to the formula above, in order to get the effective interest required, we need to get the root of equation:
$Tol-\sum^{30}_{t= 1} Commision\times ({\frac{1}{1+i_e}})^t=0 $
Using uniroot function, the answer is obtained by following steps.
```{r}
g<-function(i){Tol-sum(instal*(1/(1+i))^(1:30))}
root2<-uniroot(g,c(0,1),tol = 0.0001)
i=root2$root
i
```
### Part d
Bill's annual payments consist 2 parts: installment to pay back $600000 mortgage and 1000 to pay the commision.
First the new instalment should be determined using the formula:
$L=\sum^{30}_{t= 1} instal2\times ({\frac{1}{1+i_e}})^t $
```{r}
h<-function(instal2){Tol-sum(instal2*(1/(1+i))^(1:30))}
root3<-uniroot(h,c(0,600000),tol = 0.01)
instal2=root3$root
cat("Annul_payment:",instal2)
```
Finally we can calculate the difference between 2 annual payments:
```{r}
diff<-instal-instal2
diff
```
We can see that the annual payment of Bill would decrease by $1645.033

## Question 4
### Process date provided in the question
```{r}
lifeA<-strptime(c('1965-05-15','1985-07-21','1994-06-24'),format = '%Y-%m-%d')
lifeB<-strptime(c('1922-03-01','1955-09-23','1993-07-21'),format = '%Y-%m-%d')
lifeC<-strptime(c('1942-09-21','1967-06-02','1996-04-29'),format = '%Y-%m-%d')
```

### Age next birthday at death
```{r}
Age_1_A<-floor(difftime(time1 =lifeA[3],time2 = lifeA[1],units = 'days')/365.25)+1
Age_1_B<-floor(difftime(time1 =lifeB[3],time2 = lifeB[1],units = 'days')/365.25)+1
Age_1_C<-floor(difftime(time1 =lifeC[3],time2 = lifeC[1],units = 'days')/365.25)+1
Age_1_A<-as.numeric(Age_1_A)
cat("Age next birthday at death of life A:",Age_1_A)
Age_1_B<-as.numeric(Age_1_B)
cat("Age next birthday at death of life B:",Age_1_B)
Age_1_C<-as.numeric(Age_1_C)
cat("Age next birthday at death of life C:",Age_1_C)
```
### Age last birthday an 1 January preceding death
```{r}
Jan_of_death<-strptime(c('1994-01-01','1993-01-01','1996-01-01'),format = '%Y-%m-%d')
Age_2_A<-floor(difftime(time1 = Jan_of_death[1],time2 =lifeA[1],units = 'days')/365.25)
Age_2_B<-floor(difftime(time1 = Jan_of_death[2],time2 =lifeB[1],units = 'days')/365.25)
Age_2_C<-floor(difftime(time1 = Jan_of_death[3],time2 =lifeC[1],units = 'days')/365.25)
Age_2_A<-as.numeric(Age_2_A)
cat("last birthday an 1 January preceding death of life A:",Age_2_A)
Age_2_B<-as.numeric(Age_2_B)
cat("last birthday an 1 January preceding death of life B:",Age_2_B)
Age_2_C<-as.numeric(Age_2_C)
cat("last birthday an 1 January preceding death of life A:",Age_2_C)
```
### Age at the birthday in the policy year of death
```{r}
Age_3_A<-floor(difftime(time1 =lifeA[3],time2 = lifeA[2],units = 'days')/365.25)
Age_3_B<-floor(difftime(time1 =lifeB[3],time2 = lifeB[2],units = 'days')/365.25)
Age_3_C<-floor(difftime(time1 =lifeC[3],time2 = lifeC[2],units = 'days')/365.25)
Age_3_A<-as.numeric(Age_3_A)
Age_3_B<-as.numeric(Age_3_B)
Age_3_C<-as.numeric(Age_3_C)
cat("Age next birthday at death of life A:",Age_3_A)
cat("Age next birthday at death of life B:",Age_3_B)
cat("Age next birthday at death of life C:",Age_3_C)
```